@page
@using StudentsHelper.Common;
@using StudentsHelper.Web.ViewModels.Balance;
@model Balance
@{
    ViewData["Title"] = "Баланс";
    ViewData["ActivePage"] = ManageNavPages.Balance;
}

@section ManageCss {
<link rel="stylesheet" href="~/css/balance.min.css" asp-append-version="true" />
}

<h5 class="mt-2">@ViewData["Title"]: @Model.BalanceAmount лв.</h5>
<partial name="_StatusMessage" model="Model.StatusMessage" />
@if (this.User.IsInRole(GlobalConstants.StudentRoleName))
{
    <div id="add-to-balance-container" class="mt-4 col-md-6">
        <h5>Добави (цяло число)</h5>
        <form method="POST">
            <div class="form-group">
                <label asp-for="Input.DepositRequestMoneyAmount"></label>
                <input asp-for="Input.DepositRequestMoneyAmount" class="form-control" />
            </div>
            <button type="submit" class="btn btn-primary">Плати</button>
            <br />
            <span asp-validation-for="Input.DepositRequestMoneyAmount" class="text-danger"></span>
        </form>
    </div>
}

<div id="transactions-container" class="mt-4">
    <h5>Транзакции:</h5>
    <table class="mt-3 table">
        <tbody>
            @foreach (var transaction in Model.TransactionsInfo)
            {
                if (this.User.IsInRole(GlobalConstants.StudentRoleName))
                {
                    <tr class="row">
                        <td class="col-2">@transaction.PaymentDate.ToString("dd.MM.yyyy")</td>
                        <td class="col-4">@(transaction.TeacherName == null ? "Покупка" : $"Плащане на урок с {transaction.TeacherName}")</td>
                        <td class="col-2 font-weight-bold text-right" style="color: @(@transaction.Amount > 0 ? "green" : "red")">@(@transaction.Amount > 0 ? '+' : '\0')@transaction.Amount</td>
                    </tr>
                }
            }
        </tbody>
    </table>
</div>

@section Scripts {
<partial name="_ValidationScriptsPartial" />
}
