function engine(){const n=((n=1)=>{const r=[null,activateFirstPart,activateSecondPart,activateThirdPart,activateFourthPart],t=()=>document.getElementById(`part-${n}`),i=(i,u)=>{if(isValidCurrentPart(t())){if(n==3){const n=document.getElementById("SchoolId");if(n.value==0||Array.from(n.parentNode.classList).some(n=>n==hiddenClassName))return}t().classList.add(hiddenClassName);n=u(n);r[n](i);t().classList.remove(hiddenClassName)}};return{getCurrentPart:t,showLastPart(n){n.preventDefault();i(n,n=>--n)},showNextPart(n){n.preventDefault();i(n,n=>++n)}}})();let t=Array.from(document.querySelectorAll("img.role"));t.forEach(t=>{t.addEventListener(clickEventName,n.showNextPart)});document.getElementById("past-part").addEventListener(clickEventName,n.showLastPart);document.getElementById("continue").addEventListener(clickEventName,n.showNextPart);document.getElementById("register-submit").addEventListener(clickEventName,registerUser.bind(null,n))}function isValidCurrentPart(n){const t=Array.from(n.querySelectorAll("[name]"));return t.every(n=>$(n).valid())}function registerUser(n,t){if(!isValidCurrentPart(n.getCurrentPart())){t.preventDefault();return}role=="student"&&(document.getElementById("part-3").remove(),document.getElementById("part-4").remove())}function activateFirstPart(){document.getElementById("allErrorsList").classList.remove(hiddenClassName);document.getElementById("register-submit").classList.add(hiddenClassName);document.getElementById("continue").classList.add(hiddenClassName);document.getElementById("past-part").classList.add(hiddenClassName);document.getElementById("second-auth-option").classList.add(hiddenClassName);document.querySelector(".more-options").classList.remove(hiddenClassName)}function activateSecondPart(n){document.getElementById("allErrorsList").classList.add(hiddenClassName);const t=document.getElementById("Input_Role");role=n.target.getAttribute("role");t.value=role;document.getElementById("second-auth-option-userRole").value=role;document.getElementById("past-part").classList.remove(hiddenClassName);const i=document.getElementById("register-submit"),r=document.getElementById("continue");document.getElementById("second-auth-option").classList.remove(hiddenClassName);document.querySelector(".more-options").classList.add(hiddenClassName);t.value=="student"?(i.classList.remove(hiddenClassName),r.classList.add(hiddenClassName)):(r.classList.remove(hiddenClassName),i.classList.add(hiddenClassName))}function activateThirdPart(){async function r(t){if(t+1===n.length){document.getElementById("continue").classList.remove(hiddenClassName);return}document.getElementById("continue").classList.add(hiddenClassName);for(let i=t+1;i<n.length;i++)n[i].parentNode.classList.add(hiddenClassName);i(n[t+1],n[t].value)}function i(n,t){function i(t){function r(n){let t=document.createElement("option");return t.value=n.id,t.textContent=n.name,t}const i=new DocumentFragment;let u=defaultLocationNames[n.name];i.appendChild(r({id:0,name:u}));t.forEach(n=>{i.appendChild(r(n))});n.innerHTML="";n.appendChild(i);n.parentNode.classList.remove(hiddenClassName)}n.children.length>0&&t==null||fetch(`/Locations/Get?selectName=${n.name}&lastSelectedId=${t}`).then(async n=>await n.json()).then(i)}Array.from(document.getElementById("SchoolId").parentNode.classList).some(n=>n==hiddenClassName)?document.getElementById("continue").classList.add(hiddenClassName):document.getElementById("continue").classList.remove(hiddenClassName);document.getElementById("register-submit").classList.add(hiddenClassName);document.getElementById("second-auth-option").classList.add(hiddenClassName);const t=n=>document.querySelector(`select[name="${n}"]`),n=[t("regions"),t("townships"),t("populatedAreas"),document.getElementById("SchoolId")];n.slice(0,n.length).forEach((n,t)=>n.addEventListener(chooseOptionEventName,r.bind(null,t)));i(n[0],null)}function activateFourthPart(){document.getElementById("register-submit").classList.remove(hiddenClassName);document.getElementById("continue").classList.add(hiddenClassName)}window.addEventListener("load",engine);var hiddenClassName="hidden",clickEventName="click",chooseOptionEventName="change",role=null,defaultLocationNames={regions:"Област",townships:"Община",populatedAreas:"Населено място","Input.TeacherModel.SchoolId":"Училище"};