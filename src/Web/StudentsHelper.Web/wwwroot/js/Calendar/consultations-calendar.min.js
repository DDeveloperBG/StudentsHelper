function runEngine(){try{engine()}catch(n){console.error(n)}}function engine(){$.ajax({url:"/Consultations/GetCalendarConsultations",type:"GET",dataType:"JSON",success:function(n){let t=[];$.each(n,function(n,i){t.push({id:i.id,title:`Консултация`,description:i.description,start:new moment(moment.utc(i.startTime).toDate()).format("YYYY-MM-DDTHH:mm"),end:new moment(moment.utc(i.endTime).toDate()).format("YYYY-MM-DDTHH:mm"),backgroundColor:"rgb(51, 182, 121)",borderColor:"rgb(51, 182, 121)"})});displayCalendar(t)}})}function displayCalendar(n){let t=document.getElementById("calendar"),i=new FullCalendar.Calendar(t,{locale:"bg",initialView:"dayGridMonth",editable:!0,eventDurationEditable:!1,contentHeight:"auto",dayMaxEvents:!0,headerToolbar:{left:"prev,next today",center:"title",right:"timeGridDay,timeGridWeek,dayGridMonth"},eventMouseEnter:function(n){let t=$(n.el);t.hasClass("hasTooltip")||(t.tooltip({title:n.event.extendedProps.description,placement:"top"}),t.addClass("hasTooltip"));t.triggerHandler("mouseover")},eventDrop:function(n){if(!confirm("Сигурни ли сте относно тази промяна?")){n.revert();return}let t=new moment(n.event.start).utc().format("yyyy-MM-DDTHH:mm");$.ajax({type:"POST",url:"/Consultations/ChangeConsultationStartTime",data:JSON.stringify({consultationId:n.event.id,startTime:t}),contentType:"application/json; charset=utf-8",dataType:"json",error:()=>{n.revert(),alert("Невалидни данни!")}})},events:n});i.render()}document.addEventListener("load",runEngine);